var URL_FAVORITE_MOVIE="/ajax/";var URL_FLAG_MOVIE="/ajax/flagMovie";var URL_DELETE_MOVIE="/ajax/deleteMovie";var URL_BULK_DELETE_MOVIE="/ajax/bulkDeleteMovie";var URL_DELETE_MOVIE_BY_TEACHER="/ajax/deleteMovieByTeacher";var URL_UNDELETE_MOVIE="/ajax/undeleteMovie";var URL_BULK_UNDELETE_MOVIE="/ajax/bulkUndeleteMovie";var URL_REJECT_MOVIE="/ajax/rejectMovie";var URL_DELETE_FAVORITE="/ajax/deleteFavorite";var URL_STAFFPICKS_MOVIE="/ajax/addStaffpicksMovie";var URL_ADD_BEST_ANIMATION="/ajax/addBestAnimation";var URL_ADD_FEATUED_ANIMATION="/ajax/addFeaturedAnimation";var URL_SET_COPYABLE="/ajax/setcopyable";var URL_SET_PUBLISHED="/ajax/setpublished";var URL_SET_PRIVATE_SHARE="/ajax/setprivateshare";var URL_SET_PRIVATE_SHARE_FOR_SCHOOL="/ajax/setprivateshareforschool";var URL_SET_PUBLISHED_PSHARE="/ajax/setpublishedpshare";var URL_CHECK_MOVIE_COPY="/ajax/checkCopyMovie";var URL_SUBMIT_POLL="/ajax/submitPoll";var URL_CHECK_MOVIE_EDIT="/ajax/checkEditMovie";var URL_SET_ALLOW_DOWNLOAD="/ajax/setAllowDownload";var URL_RECOMMEND="/ajax/movie_recommend";var URL_POSTOGROUP="/ajax/postToGroup";var _publishStatusHistory=[];var _pshareStatusHistory=[];function checkEditMovie(movie_id){jQuery.post(URL_CHECK_MOVIE_EDIT+"/"+movie_id,function(response){parseResponse(response);if(typeof responseArray.json.url!="undefined"){if(responseArray.json.url=="reload"){window.location=window.location}else{var _script;if(_script=responseArray.json.url.match(/^javascript:(.*)$/)){eval(_script[1])}else{window.location=responseArray.json.url}}}else{if(responseArray.code=="0"){var html=responseArray.html;if(view_name=="school"){var $htmlsch=$(html);$htmlsch.appendTo("body").modal()}else{if(view_name=="go"){var $html=$(html);$html.appendTo("body").modal()}else{if(view_name=="ed"){showOverlay($(html),{top:"110px",position:"absolute"})}else{showHTMLBox(GT.gettext("Recover Animation"),180,html,"autosave_dialog",undefined,true)}}}jQuery("#altime, #alatime").each(function(){jQuery(this).html(autosaveTimeFormat(jQuery(this).html()))})}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function autosaveTimeFormat(d){var c=convertTime(d);var b=new Date(d*1000);var a=b.getFullYear();var e=c.indexOf(a);if(e>0){c=c.replace(a,a+"<br/>")}return c}function convertTime(e){var c=new Date(e*1000);var a=c.toLocaleString();var f=c.getTimezoneOffset();var d=a.indexOf("(");if(d>0){a=a.substring(0,d)}if(a.indexOf("GMT")<0){var b=Math.abs(f/60);if(b<10){b="0"+b}b=b+"00";if(f>0){a=a+" GMT-"+b}else{a=a+" GMT+"+b}}return a}function favoriteMovie(d,c,b,a){ga("send","pageview","/pageTracker/ajax/favoriteMovie");new Ajax.Request(URL_FAVORITE_MOVIE+c+"/"+d,{method:"post",onSuccess:function(f){var e=f.responseText;favoriteMovieComplete(e,c,b,a)},onFailure:function(){displayFeedback("1"+GT.gettext("Error contacting the server"))}})}function flagMovie(a){ga("send","pageview","/pageTracker/ajax/flagMovie");new Ajax.Request(URL_FLAG_MOVIE+"/"+a,{method:"post",onSuccess:function(c){var b=c.responseText;flagMovieComplete(b)},onFailure:function(){displayFeedback("1"+GT.gettext("Error contacting the server"))}})}function favoriteMovieComplete(b,d,c,a){parseResponse(b);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){if(d=="deleteFavorite"){displayFeedback(responseArray.code+GT.gettext("Video removed from your recommendations"))}else{displayFeedback(responseArray.code+GT.gettext("Video added to your recommendations"))}$(c).style.display="none";$(a).style.display="block"}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()}function flagMovieComplete(a){parseResponse(a);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+GT.gettext("Video flagged as inappropriate"))}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()}function deleteMovie(b,c,d){if(c=="1"){var a=URL_DELETE_MOVIE+"/"+b}else{var a=URL_UNDELETE_MOVIE+"/"+b}jQuery.post(a,function(e){if(e.success==true){if(d=="true"){window.location="/movies"}else{if(c=="1"){displayFeedback("0"+GT.gettext("This movie has successfully been moved to your trash."))}else{displayFeedback("0"+GT.gettext("This movie has successfully been recovered."))}$("#movie_container").html(e.html);$("#video_count").html(e.video_count);$("#deleted_video_count").html(e.deleted_video_count)}}else{displayFeedback("1"+e.error)}},"json")}function deleteMovieAlert(a,b){jQuery.post("/ajax/getMovieDeleteAlert",{enc_movie_id:a,redirect:b},function(c){if(c.error){displayFeedback("1"+c.error);return}jQuery("#delete_movie_alert").remove();jQuery("body").append(c.html);jQuery("#delete_movie_alert").modal({show:true})},"json")}function confirmDeleteMovie(a,b){deleteMovie(a,"1",b);if(b=="false"){jQuery("#delete_movie_alert").modal("hide")}}function bulkDeleteMovieAlert(a){console.log(a);jQuery.post("/ajax/getBulkMovieDeleteAlert",{enc_movie_id_list:a.join()},function(b){if(b.error){displayFeedback("1"+b.error);return}jQuery("#delete_movie_alert").remove();jQuery("body").append(b.html);jQuery("#delete_movie_alert").modal({show:true})},"json")}function bulkDeleteMovie(a){jQuery.post(URL_BULK_DELETE_MOVIE,{enc_movie_id_list:a},function(b){if(b.html){$("#movie_container").html(b.html);$("#video_count").html(b.video_count);$("#deleted_video_count").html(b.deleted_video_count);jQuery("#delete_movie_alert").modal("hide");displayFeedback("0The movies you have selected has successfully been moved to your trash.")}if(b.error){displayFeedback("1"+b.error)}},"json")}function deleteMovieByTeacher(d,b,e,a){var g=GT.gettext("You will not be able to watch this video any more!");if(!confirm(g)){return}else{if(b&&e&&a){var f=$(e).innerHTML-0;var c=URL_DELETE_MOVIE_BY_TEACHER+"/"+d+"/"+b+"/"+f}else{var c=URL_DELETE_MOVIE_BY_TEACHER+"/"+d}new Ajax.Request(c,{method:"post",onSuccess:function(k){var j=k.responseText;parseResponse(j);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+GT.gettext("Video has been deleted"));if(b&&e&&a){$(a).innerHTML=responseArray.html;if(jQuery){var h=jQuery.Event("delete");h.hasNextPage=(responseArray.json.next_page==1);h.movieId=d;jQuery("#"+a).trigger(h)}}}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()},onFailure:function(){displayFeedback("1Error contacting the server")}})}}function rejectMovie(b){var c="Are you sure you want to reject this video?";if(!confirm(c)){return}else{var a=URL_REJECT_MOVIE+"/"+b;new Ajax.Request(a,{method:"post",onSuccess:function(e){var d=e.responseText;parseResponse(d);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Video has been rejected")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()},onFailure:function(){displayFeedback("1Error contacting the server")}})}}function deleteFavorite(c,a,d,b){var f=GT.gettext("Are you sure you want to remove this movie from your favorite list?");if(!confirm(f)){return}else{var e=$(d).innerHTML-0;new Ajax.Request(URL_DELETE_FAVORITE+"/"+c+"/"+a+"/"+e,{method:"post",onSuccess:function(h){var g=h.responseText;parseResponse(g);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+GT.gettext("Video has been removed from your recommendations"));$(b).innerHTML=responseArray.html}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()},onFailure:function(){displayFeedback("1"+GT.gettext("Error contacting the server"))}})}}function copyMovie(b,a){var c="This movie was not created on this site.\nAre you sure to copy it to this site?";if(confirm(c)){checkCopyMovie(b,a)}}function editMovie(a){var b="To edit this movie, you are about to leave this site.\nDo you want to continue?";if(confirm(b)){location.href=a}}function staffpicksMovie(a){var b="Are you sure to Staffpicks this Video?";if(!confirm(b)){return}else{new Ajax.Request(URL_STAFFPICKS_MOVIE+"/"+a,{method:"post",onSuccess:function(d){var c=d.responseText;parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"The video has been added to Staffpicks")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()},onFailure:function(){displayFeedback("1Error contacting the server")}})}}function addBestAnimation(a){var b="Are you sure to add this video as one of the best videos?";if(!confirm(b)){return}new Ajax.Request(URL_ADD_BEST_ANIMATION+"/"+a,{method:"post",onSuccess:function(d){var c=d.responseText;parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"The animation is one of the best animations now")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()},onFailure:function(){displayFeedback("1Error contacting the server")}})}function featureAnimation(a){var b="Are you sure to feature this video?";if(!confirm(b)){return}else{new Ajax.Request(URL_ADD_FEATUED_ANIMATION+"/"+a,{method:"post",onSuccess:function(d){var c=d.responseText;parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"The animation has been added as featured animation")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()},onFailure:function(){displayFeedback("1Error contacting the server")}})}}function registerMoviePublishStatusHistory(b,a){_publishStatusHistory[b]=a}function getMoviePublishStatusHistory(a){if(!_publishStatusHistory[a]){return null}return _publishStatusHistory[a]}function registerMoviePshareStatusHistory(b,a){_pshareStatusHistory[b]=a}function getMoviePshareStatusHistory(a){if(!_pshareStatusHistory[a]){return null}return _pshareStatusHistory[a]}function updateMovieStatus(f,h,g,e,b,d,a){ga("send","pageview","/pageTracker/ajax/"+f+"/"+b);var c;switch(f){case"copy":c=URL_SET_COPYABLE+"/"+e+"/"+b;break;case"publish":c=URL_SET_PUBLISHED+"/"+e+"/"+b;break;case"pshare":c=URL_SET_PRIVATE_SHARE+"/"+e+"/"+b;break;case"pshareteacher":c=URL_SET_PRIVATE_SHARE_FOR_SCHOOL+"/"+e+"/"+b;break;case"publishpshare":c=URL_SET_PUBLISHED_PSHARE+"/"+e+"/"+b;break}new Ajax.Request(c,{method:"post",onSuccess:function(m){var j=m.responseText;parseResponse(j);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){if($("movie_thumb_"+e)){$("movie_thumb_"+e).src="/static/go/img/v2/"+d+"_overlay.gif"}else{if(f!="copy"&&$("animation_"+e)){var l=jQuery("#animation_"+e);var k=["public","private","draft","processing","hidden"].filter(function(o,n,p){return l.hasClass(o)})[0];l.trigger("updateMovieStatus",[k,d])}}if($(h)){$(h).show()}if($(g)){$(g).hide()}if(f=="pshare"){registerMoviePshareStatusHistory(e,b);if(b=="1"){if($(a)){$(a).triggerPshareStatusChange(e,true)}}else{if($(a)){$(a).triggerPshareStatusChange(e,false)}}}if(f=="publish"){registerMoviePublishStatusHistory(e,b);if(b=="1"){if($(a)){$(a).triggerPublishStatusChange(e,true)}}else{if($(a)){$(a).triggerPublishStatusChange(e,false)}}}if(f=="publishpshare"){registerMoviePshareStatusHistory(e,b);registerMoviePublishStatusHistory(e,b);if(b=="1"){if($(a)){$(a).triggerPshareStatusChange(e,false);$(a).triggerPublishStatusChange(e,true)}}else{if($(a)){$(a).triggerPublishStatusChange(e,false);$(a).triggerPshareStatusChange(e,true)}}}if(b==1){schoolMoviePublish(true)}else{schoolMoviePublish(false)}}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()},onFailure:function(){displayFeedback("1Error contacting the server")}})}function updatePrivateSharing(a,b,c){if(a){if(c){$(c).hide()}if(b){$(b).show()}}else{if(c){$(c).show()}if(b){$(b).hide()}}}function setPrivateSharing(a){is_private_sharing=a;return}function postToGroup(c,a,e,d){var f={};var b=URL_POSTOGROUP+"/"+c+"/"+a;var e=e||"";var d=d||"";if(e){f.group=e}if(d){f.ct=d}else{f.ct=jQuery("input[name=ct]").val()}jQuery.post(b,f,function(g){parseResponse(g);if(responseArray.code=="0"){if(jQuery("#movie-select-group").length){jQuery("#movie-select-group").modal("hide")}if(a==1){displayFeedback("0This video is visible to members of the group: "+responseArray.json.group_name);jQuery("#publish_group_button").text(responseArray.json.group_name);jQuery("#unpublish_button").show()}else{displayFeedback("0This movie is now hidden from all groups");jQuery("#publish_group_button").text("Choose ...");jQuery("#unpublish_button").hide()}}else{if(!responseArray.json.select_group){displayFeedback(responseArray.code+"Error")}else{if(jQuery("#movie-select-group").length!=0){jQuery("#movie-select-group").remove()}jQuery("body").append(responseArray.html);$("#movie-select-group").modal("show")}}})}function checkCopyMovie(b,a){jQuery.post(URL_CHECK_MOVIE_COPY+"/"+a,function(c){if(c.error){displayFeedback("1"+c.error)}if(c.free=="true"){location.href=b}else{displayFeedback("1Copying this movie is not allowed")}},"json")}function toggleGigya(){if($("divWildfirePost").visible()){$("divWildfirePost").hide()}else{$("divWildfirePost").show()}}var to;function toggleUserStats(){showHideContent("1");$("toggleLink").writeAttribute("expanded",1-($("toggleLink").readAttribute("expanded")||"0"));if($("toggleLink").readAttribute("expanded")=="1"){$("toggleLink").innerHTML=GT.gettext("minimize");$("short_description").hide();$("join_date").style.display="block";$("userstats").style.height="55px"}else{$("toggleLink").innerHTML=GT.gettext("more");$("join_date").style.display="none";$("short_description").show();$("userstats").style.height="27px"}}function toggleMessagePreview(a,c,b){if(b){$(a).style.display="block";$(c).style.display="block"}else{$(a).style.display="none";$(c).style.display="none"}}function sendFBContent(){new Ajax.Request("/ajax/boxChannel/"+jQuery("#channel-dropdown").getSSKey(),{method:"post",onSuccess:function(b){var a=b.responseText;parseResponse(a);$("channel_content_div").innerHTML=responseArray.html},onFailure:function(){displayFeedback("1Error contacting the server")}})}function showSurveyOverlay(b){var a=currPos();a[1]=a[1]+100;$("surveyoverlay").style.display="block";$("overlayObject").style.margin=a[1]+"px 0px 0px 0px";if(b){grayOut(true,"showSurvey")}else{grayOut(false,"showSurvey")}}function hideSurvey(){grayOut(false,"showSurvey");$("surveyoverlay").style.display="none"}function submitPoll(){for(i=0;i<document.surveyForm.answer.length;i++){if(document.surveyForm.answer[i].checked){ans=document.surveyForm.answer[i].value}}other=document.surveyForm.other.value;if(ans!="no"&&ans!="yes"){other=ans;ans="yes"}new Ajax.Request(URL_SUBMIT_POLL+"/"+ans+"/"+other,{method:"post",onSuccess:function(b){var a=b.responseText;parseResponse(a);hideSurvey()},onFailure:function(){displayFeedback("1Error contacting the server")}})}function submitPollKeyPress(b){document.surveyForm.answer[2].checked=true;var a;if(b&&b.which){b=b;a=b.which}else{b=event;a=b.keyCode}if(a==13){submitPoll();return false}else{return true}}function setAllowDownload(b,a){new Ajax.Request(URL_SET_ALLOW_DOWNLOAD+"/"+b+"/"+a,{method:"post",onSuccess:function(d){var c=d.responseText;parseResponse(c);if(a){jQuery("#downloadable").hide();jQuery("#notDownloadable").show()}else{jQuery("#downloadable").show();jQuery("#notDownloadable").hide()}},onFailure:function(){displayFeedback("1Error contacting the server")}})}function showPublishOptions(a){if(a){jQuery(".publish_options").show()}else{jQuery(".publish_options").hide()}}function handleFacebookLike(a){ga("send","pageview","/pageTracker/ajax/fbLike");jQuery("#recommend_button").trigger("click")}function recommendMovie(a){ga("send","pageview","/pageTracker/ajax/favoriteMovie");jQuery.post(URL_RECOMMEND,{movie_id:a},function(b){parseResponse(b);if(responseArray.code==0){jQuery(".recommend_button").replaceWith(responseArray.html);jQuery(".recommend_num").html("("+responseArray.json.num_favorited+")");displayFeedback("0"+responseArray.json.message)}else{displayFeedback("1"+responseArray.json.error)}resetResponse()})}function handleFacebookShare(b,a){FB.getLoginStatus(function(c){if(c.session){getMovieFBMLShareOverlay(a)}else{FB.ui({method:"share",href:b})}})}function getMovieFBMLShareOverlay(a){if(!jQuery("#movie_fbml_share_overlay").length){jQuery.get("/ajax/getMovieFBMLShareOverlay/"+a,function(b){parseResponse(b);if(responseArray.code=="0"){document.getElementById("offer_container").innerHTML=responseArray.html;FB.XFBML.parse(document.getElementById("movie_fbml_share_overlay"));showOfferOverlay(jQuery("#movie_fbml_share_overlay"))}else{displayFeedback("1"+responseArray.error)}})}else{FB.XFBML.parse(document.getElementById("movie_fbml_share_overlay"));showOfferOverlay(jQuery("#movie_fbml_share_overlay"))}}function getMovieYoutubeExportOverlay(a){jQuery.get("/ajax/getMovieYoutubeExportOverlay/"+a,function(b){parseResponse(b);if(responseArray.code=="0"){var c=jQuery("#movie_youtube_export_overlay");if(c.length){c.replaceWith(responseArray.html)}else{jQuery("body").append(responseArray.html);jQuery(".youtube_export_button").live("click",function(){window.open(jQuery(this).attr("href"),"_ga_youtube_export","toolbar=no,status=no,height=500,width=960")})}showOfferOverlay(jQuery("#movie_youtube_export_overlay"))}else{displayFeedback("1"+responseArray.json.error)}})}function getVideoExportOverlay(b,a){jQuery.get("/ajax/getVideoExportOverlay/"+b+"/"+a,function(c){if(c.error){return}jQuery("#video-export-overlay").remove();jQuery("body").append(c.html);var d=jQuery("#video-export-overlay").modal({show:true});d.data("videoExport",videoExport=new VideoExport(d))},"json")}function getMovieSharePanel(a){jQuery.get("/ajax/getMovieShare/"+a,function(b){if(b.error){displayFeedback("1"+b.error);return}jQuery("#export-content").remove();jQuery("body").append(b.html);jQuery("#export-content").modal({show:true})},"json")}function getGroup(a,b,c){jQuery.get("/ajax/getGroup/"+a+"/"+b+"/"+c,function(d){if(d.error){return}jQuery("#group-content").remove();jQuery("body").append(d.html);jQuery("#group-content").modal({show:true});toggleBlock("#students_not_in_class","#students_in_class");jQuery("#add_students").addClass("on");jQuery("#members").removeClass("on")},"json")}function showYoutubeAd(){var a=jQuery("#youtube_button");if(!a.length){return}var e=a.offset();var d=jQuery("#youtube_overlay_ad").clone().appendTo("body");jQuery("#youtube_overlay_ad").remove();var b=e.top-d.height()+a.height();var c=e.left-(d.width()/2)+(a.width()/2)+3;d.css("top",b+"px");d.css("left",c+"px");d.css("z-index","50");jQuery("#darkenScreenObject").show();d.css("display","block")}function showYoutubeAd2(){var a=jQuery("#youtube_upgrade_button");if(!a.length){return}var e=a.offset();var d=jQuery("#youtube_overlay_ad2").clone().appendTo("body");jQuery("#youtube_overlay_ad2").remove();var b=e.top-d.height()+a.height()+2;var c=e.left-(d.width()/2)+(a.width()/2)-23;d.css("top",b+"px");d.css("left",c+"px");d.css("z-index","50");jQuery("#darkenScreenObject").show();d.css("display","block")}function hideYoutubeAd(a){jQuery(a+", #darkenScreenObject").hide()}function embedMovieInfo(a){jQuery.post("/ajax/getMovieEmbedInfo/"+a,function(b){showOverlay(b,{top:"200px"})})}var VideoExport=function(a,b){var c=this;this.$el=a;this.options=b;this.$el.on("click.video.goanimate","[data-video-export]",function(f){var d=$(this);f.preventDefault();if(d.data("videoExport")=="youtube"){c.popWindow(d.attr("href"))}else{c.requestExport(d.attr("href"))}}).on("exportError",function(f,d){c.alert(d.error,"danger")}).on("exportSuccess",function(f,d){c.requestSuccess(d)}).on("change.video.goanimate keyup.video.goanimate",'[data-action="wevideo-auth"] input[name="email"]',function(d){if(!c.$el.find(".wevideo-export-authorize-action span:visible").hasClass("wevideo-export-authorize-button")){c.$el.find(".wevideo-export-authorize-action").find("span").hide().end().find(".wevideo-export-authorize-button").show()}}).on("submit.video.goanimate",'[data-action="wevideo-auth"]',function(f){var d=$(this);f.preventDefault();d.find(".wevideo-export-authorize-action").find("span").hide().end().find(".wevideo-export-authorize-loading").show();jQuery.ajax({type:"POST",url:d.attr("action"),data:d.serialize(),success:function(e){if(e.suc){d.parents(".modal-body").find(".pick-resolution .wevideo_email").text(d.find('input[name="email"]').val());d.find(".wevideo-export-authorize-action").find("span").hide().end().find(".wevideo-export-authorize-message-success").show();c.$el.find('[data-action="wevideo-proceed-export"]').prop("disabled",false)}else{d.find(".wevideo-export-authorize-action").find("span").hide().end().find(".wevideo-export-authorize-message-fail").show()}},error:function(){c.alert(GT.gettext("Error contacting the server"),"error")},dataType:"json"})}).on("click.video.goanimate",'[data-action="wevideo-proceed-export"]',function(d){c.$el.find(".modal-body").addClass("authorized").end().find('.modal-footer [data-action="wevideo-proceed-export"]').hide().end().modal("layout")}).on("click.video.goanimate",'[data-action="wevideo-reset"]',function(f){var d=$(this);f.preventDefault();$.get("/ajax/wevideo/logout",function(e){c.$el.find(".modal-body").removeClass("authorized").end().find('.modal-footer [data-action="wevideo-proceed-export"]').prop("disabled",true).show().end().modal("layout")})})};VideoExport.prototype=$.extend({},{popWindow:function(a){window.open(a,"_go_video_export","toolbar=no,status=no,height=650,width=960")},requestExport:function(a){var b=this;$.get(a,function(c){if(c.error){b.alert(c.error,"danger");return}b.requestSuccess(c)},"json").fail(function(c){b.alert("Error contacting server ("+c.status+"). Please try again later / reload the page.","error")})},requestSuccess:function(a){if(a.resolution){this.$el.find("."+a.resolution+" .video-export-action").html('<span class="btn btn-dark">'+GT.gettext("Processing")+"...</span>");switch(a.type){case"youtube":this.alert(GT.gettext("Your video is being converted and will be exported to YouTube. You can close this window."));break;default:this.alert(GT.gettext("When your video is ready to be downloaded, it will appear on your Dashboard. You can close this window."))}}},alert:function(b,a){a=a||"success";this.$el.find(".alert").remove();var c=$('<div class="alert"><button type="button" class="close" data-dismiss="alert">&times;</button></div>');c.addClass("alert-"+a).append(b).prependTo(this.$el.find(".modal-body"))}});window.videoExportError=function(a){$("#video-export-overlay").trigger("exportError",[a])};window.videoExportStarted=function(a){$("#video-export-overlay").trigger("exportSuccess",[a])};
